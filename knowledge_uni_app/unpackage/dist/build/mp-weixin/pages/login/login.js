(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"1b2f":function(e,t,n){},"39d6":function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var i=function(){var e=this,t=e.$createElement;e._self._c},o=[]},"46e7":function(e,t,n){"use strict";(function(e){n("1754");a(n("66fd"));var t=a(n("b5ce"));function a(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"85dd":function(e,t,n){"use strict";n.r(t);var a=n("913c"),i=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},"913c":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("fba3"));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){n.e("components/uni-ui/uni-status-bar/uni-status-bar").then(function(){return resolve(n("3b31"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/common/other-login").then(function(){return resolve(n("c4c1"))}.bind(null,n)).catch(n.oe)},r=getApp(),u={components:{uniStatusBar:o,otherLogin:s},data:function(){return{agree:!1,iswechat:1,status:"",login_by_wx:!1,login_by_qq:!1,username:"",usernameFlag:"",password:"",phone:"",code:"",codeTime:0,loginType:"",placeholder:"请输入验证码",get_captcha_txt:"",foretPass:"",isForgetShow:!1,smsType:0,sign:"",jumpPage:"",keyword:"",unionid:"",nickName:"",avatar:"",canshowcode:!1}},onReady:function(){this.iswechat=0,this.login_by_wx=!0},onLoad:function(t){""!=t.page&&(this.jumpPage=t.page),""!=t.keyword&&(this.keyword=t.keyword);var n=e.getSystemInfoSync(),a=n.statusBarHeight;this.statusBarHeight=a,this.loginType="captcha",this.get_captcha_txt="获取验证码"},computed:{enabled:function(){return""==this.username||""==this.password}},methods:{username_input:function(e){11==e.detail.value.length?this.canshowcode=!0:this.canshowcode=!1},agreeme:function(){1==this.agree?this.agree=!1:this.agree=!0},gotoxieyi:function(t){"1"==t?e.navigateTo({url:"../login/xieyi?type=4",success:function(e){},fail:function(){},complete:function(){}}):e.navigateTo({url:"../login/xieyi?type=5",success:function(e){},fail:function(){}})},qqlogin:function(){if(0!=this.agree);else e.showToast({title:"请阅读并同意相关协议",icon:"none"})},wechatlogin:function(){var t=this;if(0!=this.agree){var n=r.globalData;e.showLoading({title:"登录中...",mask:!1});var a=this;e.login({success:function(i){e.hideLoading(),a.code=i.code,e.getUserInfo({success:function(i){var o=JSON.parse(i.rawData);t.nickName=o.nickName,t.avatar=o.avatarUrl,e.request({url:n.site_url+"App.Login.getUnionid",method:"GET",data:{code:a.code},success:function(t){var n=t.data.data.openid;r.globalData.openid=n,e.setStorage({key:"openid",data:n,success:function(){}}),a.thirdlogin(n,a.nickName,a.avatar,2,3)}})}})}})}else e.showToast({title:"请阅读并同意相关协议",icon:"none"})},thirdlogin:function(t,n,a,i,o){e.showLoading({title:"加载中",mask:!1});var s=this.sort2url({openid:t,type:i});e.request({url:r.globalData.site_url+"Login.LoginByThird",method:"POST",data:{openid:t,source:o,type:i,nicename:n,avatar:a,sign:s},success:function(t){e.hideLoading(),e.showToast({icon:"none",title:t.data.data.msg,duration:2e3}),0===parseInt(t.data.data.code)&&(r.globalData.userinfo=t.data.data.info[0],e.setStorage({key:"userinfo",data:t.data.data.info[0],success:function(){}}),setTimeout((function(){var t="../index/index",n=r.globalData;""!=n.login_jump.page&&(t=n.login_jump.page),e.reLaunch({url:t})}),2e3))}})},register:function(){e.navigateTo({url:"../reg/reg"})},back:function(){e.reLaunch({url:"../index/index"})},initForm:function(){this.username="",this.password="",this.phone="",this.code="",this.isForgetShow=!1},chanloginType:function(e){"captcha"==e?(this.loginType="captcha",this.placeholder="请输入验证码",this.get_captcha_txt="获取验证码",this.foretPass="",this.isForgetShow=!1):"pass"==e&&(this.loginType="pass",this.placeholder="请输入密码",this.get_captcha_txt="",this.foretPass="忘记密码",this.isForgetShow=!0)},getSmsCode:function(){var t=this;if(this.usernameFlag==this.username&&this.codeTime>0)e.showToast({icon:"none",title:"验证码5分钟有效, 请勿多次发送"});else if(this.validate()){var n=this.sort2url({account:this.username});e.request({url:r.globalData.site_url+"Login.GetCode",data:{account:this.username,type:this.smsType,sign:n,env:"weixin"},success:function(n){e.showToast({icon:"none",title:n.data.data.msg}),0===parseInt(n.data.data.code)&&(t.codeTime=300,t.usernameFlag=t.username)}});var a=setInterval((function(){t.codeTime>=1?t.codeTime--:(t.codeTime=0,clearInterval(a))}),1e3)}},validate:function(){var t=/^1[3456789][0-9]\d{8}$/;return this.phone=this.username,!!t.test(this.phone)||(e.showToast({title:"手机号格式不正确",icon:"none",duration:2e3}),!1)},sort2url:function(e){for(var t=Object.keys(e).sort(),n={},i=0;i<t.length;i++)n[t[i]]=e[t[i]];var o="";for(var s in n)o=o+s+"="+n[s]+"&";return o=o.substr(0,o.length-1),o+="&"+r.globalData.sign_key,a.default.hex_md5(o)},submit:function(){if(0!=this.agree){var t,n;if("captcha"==this.loginType){if(!this.validate())return;var a=this.sort2url({username:this.username});t=r.globalData.site_url+"Login.LoginByCode",n={username:this.username,code:this.password,source:3,sign:a,env:"weixin"}}else t=r.globalData.site_url+"Login.Login",n={username:this.username,pass:this.password};e.showLoading({title:"",mask:!1}),e.request({url:t,data:n,success:function(t){e.hideLoading(),e.showToast({icon:"none",title:t.data.data.msg,duration:2e3}),0===parseInt(t.data.data.code)&&(r.globalData.userinfo=t.data.data.info[0],e.setStorage({key:"userinfo",data:t.data.data.info[0],success:function(){}}),setTimeout((function(){var t="../index/index",n=r.globalData;""!=n.login_jump.page&&(t=n.login_jump.page),e.reLaunch({url:t})}),0))},fail:function(){e.hideLoading(),e.showToast({title:"网络错误",icon:"none"})}})}else e.showToast({title:"请阅读并同意相关协议",icon:"none"})}}};t.default=u}).call(this,n("543d")["default"])},b5ce:function(e,t,n){"use strict";n.r(t);var a=n("39d6"),i=n("85dd");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("e39e");var s,r=n("f0c5"),u=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],s);t["default"]=u.exports},e39e:function(e,t,n){"use strict";var a=n("1b2f"),i=n.n(a);i.a}},[["46e7","common/runtime","common/vendor"]]]);